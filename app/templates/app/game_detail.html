{% extends 'base.html' %}
{% load static %}

{% block main %}
<div class="game-detail">
    <h2>{{ game.name }}</h2>

    <div class="game-image">
        {% if game.image %}
            <img src="{{ game.image.url }}" alt="{{ game.name }}">
        {% else %}
            <img src="{% static 'images/no_image.png' %}" alt="–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
        {% endif %}
    </div>

    <p class="description">{{ game.description }}</p>

    <p><strong>–ñ–∞–Ω—Ä—ã:</strong>
        {% for genre in game.genre.all %}
            {{ genre.name }}{% if not forloop.last %}, {% endif %}
        {% empty %}
            –ù–µ—Ç –∂–∞–Ω—Ä–æ–≤.
        {% endfor %}
    </p>

    <p>
        <strong>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:</strong>
        {% if game.studio %}
            <a href="{% url 'studio_detail' game.studio.id %}">{{ game.studio.name }}</a>
        {% else %}
            –ù–µ —É–∫–∞–∑–∞–Ω.
        {% endif %}
    </p>

    <div class="reactions">
        <form action="{% url 'add_reaction' game.id %}" method="post">
            {% csrf_token %}
            <button type="submit" name="reaction_type" value="like">üëç</button>
            <button type="submit" name="reaction_type" value="dislike">üëé</button>
        </form>
    </div>

    <h3>–û—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</h3>
    <ul>
        {% for review in game.reviews.all %}
            <li>
                <strong>{{ review.user.username }}</strong> ({{ review.created_at|date:"d.m.Y H:i" }}):<br>
                {{ review.content }}
                {% if request.user == review.user %}
                    <a href="{% url 'review_update' review.id %}">–ò–∑–º–µ–Ω–∏—Ç—å</a>
                    <a href="{% url 'review_delete' review.id %}">–£–¥–∞–ª–∏—Ç—å</a>
                {% endif %}
            </li>
        {% empty %}
            <p>–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
        {% endfor %}
    </ul>

    {% if user.is_authenticated %}
        <h4>–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤:</h4>
        <form action="{% url 'review_create' game.id %}" method="post">
            {% csrf_token %}
            <textarea name="content" rows="3" cols="50" placeholder="–í–∞—à –æ—Ç–∑—ã–≤..."></textarea><br>
            <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>

        <p>
            <a href="{% url 'create_report' game.id %}">–ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ —ç—Ç—É –∏–≥—Ä—É</a>
        </p>
    {% else %}
        <p>–ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –∏–ª–∏ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è ‚Äî <a href="{% url 'login' %}">–≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç</a>.</p>
    {% endif %}
</div>
{% endblock %}
